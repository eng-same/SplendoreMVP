@model TopNSoldProductVM

<div class="container my-5">
    <h2 class="text-center mb-4">
        🏆 Top @Model.N Best-Selling Products
    </h2>
    <p class="text-center text-muted">
        From @Model.StartDate.ToString("MMM dd, yyyy") to @Model.EndDate.ToString("MMM dd, yyyy")
    </p>

    @if (Model.Products.Any())
    {
        <div class="row row-cols-1 row-cols-md-3 g-4 mt-4">
            @foreach (var (product, index) in Model.Products.Select((value, i) => (value, i)))
            {
                <div class="col">
                    <div class="card h-100 shadow-sm border-0" style="background-color:#FDFBF7;">
                        <!-- Rank Badge -->
                        <span class="position-absolute top-0 start-0 m-2 badge rounded-pill bg-success">
                            #@(index + 1)
                        </span>

                        <!-- Product Image -->
                        <img src="@(string.IsNullOrEmpty(product.ImageUrl) ? "/images/products/placeholder.jpg" : product.ImageUrl)"
                             class="card-img-top rounded-top"
                             alt="@product.ProductName"
                             style="height:200px; object-fit:cover;" />

                        <!-- Product Info -->
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title text-dark">@product.ProductName</h5>
                            <p class="text-muted mb-2">Sold: <strong>@product.TotalQuantitySold</strong></p>
                            <p class="fw-bold text-secondary">Revenue: @product.TotalRevenue.ToString("C")</p>

                            <div class="mt-auto">
                                <a asp-controller="Home" asp-action="Details" asp-route-id="@product.ProductId"
                                   class="btn btn-sm btn-outline-dark rounded-pill">
                                    View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="alert alert-info text-center mt-4">
            No sales found in this period.
        </div>
    }
</div>
